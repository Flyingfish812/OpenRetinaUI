# Model Parameters Explanation

## KlindtCoreReadout2D

Parameter list:

| Name            | Type                                    | Part                                                                    | Description                                                                        | Example fill                                                            |
|---------------------|-----------------------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| image\_size          | int                                     | General                                                                          | 图像尺寸                                                                                     | 108                                                                                  |
| image\_channels      | int                                     | Core                                                                               | 图像通道数                                                                                   | 1                                                                                  |
| kernel\_sizes        | Iterable[int \| Iterable[int]]          | Core                                                                               | 卷积核尺寸                                                                                   | [[7,7]]                                                                           |
| num\_kernels         | Iterable[int]                           | Core, Readout                                                                   | 每层卷积核数量                                                                                | [16]                                                                           |
| act\_fns             | Iterable[str]                           | Core                                                                              | 激活函数列表                                                                                  | ['relu']                                                                          |
| reg                 | Iterable[float]                         | Core, Readout                                                                      | 正则化参数                                                                                   | [1e-4,1e-4,1e-4,0.2]                                                             |
| init\_scales         | Iterable[Iterable[float]]               | Core                                           | 3x2矩阵: [kernel, mask, weights] x [mean, std]                                               | [[0.0, 0.1], [0.0, 0.05], [0.0, 0.05]]         |
| kernel\_constraint   | Optional[str]                           | Core                                                                      | 卷积核约束，默认None                                                                          | "norm"                                                                    |
| batch\_norm          | bool                                    | Core                                                               | 是否使用批归一化，默认True                                                                     | True                                                                 |
| bn\_cent             | bool                                    | Core                                                          | 是否使用中心化批归一化，默认False                                                              | False                                                         |
| seed                | Optional[int]                           | Core                                                                        | 随机种子，默认None                                                                            | 42                                                                          |
| num\_neurons         | int                                     | Readout                                                                      | 神经元数量，默认1                                                                             | 41                                                                           |
| final\_relu          | bool                                    | Readout                                                             | 输出是否使用ReLU，默认False                                                                    | False                                                               |
| weights\_constraint  | Optional[str]                           | Readout                                                                     | 权重约束，默认None                                                                            | "abs"                                                                       |
| mask\_constraint     | Optional[str]                           | Readout                                                                     | 掩码约束，默认None                                                                            | "abs"                                                                       |
| init\_mask           | Optional[torch.Tensor]                  | Readout                                                                   | 掩码初始化，默认None                                                                          | None                                                                      |
| init\_weights        | Optional[torch.Tensor]                  | Readout                                                                   | 权重初始化，默认None                                                                          | None                                                                      |
| loss                | nn.Module \| None                       | General                                     | 损失函数，默认nn.PoissonNLLLoss(log_input = False)                                            | nn.PoissonNLLLoss(log_input = False)        |
| correlation\_loss    | nn.Module \| None                       | General                                                    | 相关性损失，默认CorrelationLoss2D()                                                           | CorrelationLoss2D()                                        |
| learning\_rate       | float                                   | General                                                                       | 学习率，默认0.01                                                                              | 0.01                                                                          |
| data\_info           | Optional[dict[str, Any]]                | General                                                                     | 数据信息，默认None                                                                            | None                                                                        |

## KlindtCoreReadout3D

Parameter list:

| Name            | Type                                    | Part                                                                    | Description                                                                        | Example fill                                                            |
|---------------------|-----------------------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| image\_size          | int                                     | General                                                                          | 图像尺寸                                                                                     | 108                                                                                  |
| image\_channels      | int                                     | Core                                                                               | 图像通道数                                                                                   | 1                                                                                  |
| kernel\_sizes        | Iterable[int \| Iterable[int]]          | Core                                                                               | 卷积核尺寸                                                                                   | [[1,7,7]]                                                                         |
| num\_kernels         | Iterable[int]                           | Core, Readout                                                                   | 每层卷积核数量                                                                                | [16]                                                                           |
| act\_fns             | Iterable[str]                           | Core                                                                              | 激活函数列表                                                                                  | ['relu']                                                                          |
| reg                 | Iterable[float]                         | Core, Readout                                                                      | 正则化参数                                                                                   | [1e-4,1e-4,1e-4,0.2]                                                             |
| init\_scales         | Iterable[Iterable[float]]               | Core                                           | 3x2矩阵: [kernel, mask, weights] x [mean, std]                                               | [[0.0, 0.1], [0.0, 0.05], [0.0, 0.05]]         |
| kernel\_constraint   | Optional[str]                           | Core                                                                      | 卷积核约束，默认None                                                                          | "norm"                                                                    |
| batch\_norm          | bool                                    | Core                                                               | 是否使用批归一化，默认True                                                                     | True                                                                 |
| bn\_cent             | bool                                    | Core                                                          | 是否使用中心化批归一化，默认False                                                              | False                                                         |
| seed                | Optional[int]                           | Core                                                                        | 随机种子，默认None                                                                            | 42                                                                          |
| num\_neurons         | int                                     | Readout                                                                      | 神经元数量，默认1                                                                             | 41                                                                           |
| final\_relu          | bool                                    | Readout                                                             | 输出是否使用ReLU，默认False                                                                    | False                                                               |
| weights\_constraint  | Optional[str]                           | Readout                                                                     | 权重约束，默认None                                                                            | "abs"                                                                       |
| mask\_constraint     | Optional[str]                           | Readout                                                                     | 掩码约束，默认None                                                                            | "abs"                                                                       |
| init\_mask           | Optional[torch.Tensor]                  | Readout                                                                   | 掩码初始化，默认None                                                                          | None                                                                      |
| init\_weights        | Optional[torch.Tensor]                  | Readout                                                                   | 权重初始化，默认None                                                                          | None                                                                      |
| loss                | nn.Module \| None                       | General                                     | 损失函数，默认PoissonLoss3d                                            | None     |
| correlation\_loss    | nn.Module \| None                       | General                                                    | 相关性损失，默认CorrelationLoss3d()                                                           | CorrelationLoss3d()                                      |
| learning\_rate       | float                                   | General                                                                       | 学习率，默认0.01                                                                              | 0.01                                                                          |
| data\_info           | Optional[dict[str, Any]]                | General                                                                     | 数据信息，默认None                                                                            | None                                                                        |

## CoreReadout (Open Retina Default)

| Name                            | Type                             | Part    | Description                                          | Example fill                  |
| ------------------------------- | -------------------------------- | ------- | ---------------------------------------------------- | ----------------------------- |
| in\_shape                       | tuple\[int, int, int, int]       | General | 输入张量形状，格式为 (channels, time, height, width) | (2, 150, 18, 16)              |
| hidden\_channels                | Iterable\[int]                   | Core    | 每层隐藏通道数量                                     | \[16, 16]                     |
| temporal\_kernel\_sizes         | Iterable\[int]                   | Core    | 每层的时间维度卷积核大小                             | \[21, 11]                     |
| spatial\_kernel\_sizes          | Iterable\[int]                   | Core    | 每层的空间维度卷积核大小                             | \[11, 5]                      |
| n\_neurons\_dict                | dict\[str, int]                  | Readout | 每个数据键对应的神经元数目                           | {"session1": 41}              |
| core\_gamma\_input              | float                            | Core    | 输入通道稀疏性正则系数                               | 0.0                           |
| core\_gamma\_hidden             | float                            | Core    | 隐藏层通道稀疏性正则系数                             | 0.0                           |
| core\_gamma\_in\_sparse         | float                            | Core    | 稀疏性正则化参数（输入特有）                         | 0.0                           |
| core\_gamma\_temporal           | float                            | Core    | 时间卷积的稀疏性正则系数                             | 40.0                          |
| core\_input\_padding            | bool                             | Core    | 是否对输入通道使用padding                            | False                         |
| core\_hidden\_padding           | bool                             | Core    | 是否对隐藏层使用padding                              | True                          |
| readout\_scale                  | bool                             | Readout | 是否在readout中使用scale参数                         | True                          |
| readout\_bias                   | bool                             | Readout | 是否在readout中添加bias参数                          | True                          |
| readout\_gaussian\_masks        | bool                             | Readout | 是否使用高斯掩码而非全连接掩码                       | True                          |
| readout\_gaussian\_mean\_scale  | float                            | Readout | 高斯掩码均值初始化尺度                               | 6.0                           |
| readout\_gaussian\_var\_scale   | float                            | Readout | 高斯掩码方差初始化尺度                               | 4.0                           |
| readout\_positive               | bool                             | Readout | 是否将 readout 权重限制为正                          | True                          |
| readout\_gamma                  | float                            | Readout | readout 权重的稀疏正则系数                           | 0.4                           |
| readout\_gamma\_masks           | float                            | Readout | readout 掩码的稀疏正则系数                           | 0.0                           |
| readout\_reg\_avg               | bool                             | Readout | 是否对多个session平均readout正则项                   | False                         |
| learning\_rate                  | float                            | General | 学习率                                               | 0.01                          |
| cut\_first\_n\_frames\_in\_core | int                              | Core    | 在core中丢弃的初始时间帧数                           | 0                             |
| dropout\_rate                   | float                            | Core    | dropout比例                                          | 0.0                           |
| maxpool\_every\_n\_layers       | Optional\[int]                   | Core    | 每隔多少层使用maxpool                                | None                          |
| downsample\_input\_kernel\_size | Optional\[tuple\[int, int, int]] | Core    | 下采样输入时使用的卷积核尺寸                         | None                          |
| data\_info                      | Optional\[dict\[str, Any]]       | General | 数据信息字典，包含输入shape与神经元数目等            | {"input\_shape": (1, 36, 64)} |
